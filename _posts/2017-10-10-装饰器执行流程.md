---
title: 装饰器执行流程
author: Flowerowl
layout: post
permalink: /4038.html
views:
  - 667
categories:
  - note
tags:
  - note
---

前段时间有个同事自学Python，问我装饰器执行流程，于是总结下来。

def deco_1(func):
    print("enter into deco_1")

    def wrapper(a, b):
        print("enter into deco_1_wrapper")
        func(a, b)
        print("over deco_1")
    return wrapper


def deco_2(func):
    print("enter into deco_2")

    def wrapper(a, b):
        print("enter into deco_2_wrapper")
        func(a, b)
        print("over deco_2")
    return wrapper


@deco_1
@deco_2
def addfunc(a, b):
    print("result is %d" % (a+b))

addfunc(3, 4)


1. 执行完成之后，会输出

enter into deco_2

enter into deco_1

此时addfunc已经被包装成了addfunc = deco_1(deco_2(addfunc))

2. 执行addfunc(3, 4)

首先执行deco_1，此时deco_1中的参数func为deco_2(addfunc)，进入wrapper，输出enter into deco_1_wrapper

然后执行wrapper中的func，即deco_2(addfunc)，进入了deco_2中的wrapper，输出enter into deco_2_wrapper

此时的func为addfunc本身，执行func(a,b)，输出了result is %d 7，接着输出了over deco_2，over deco_1

3. 最终输出

    enter into deco_2
    enter into deco_1
    enter into deco_1_wrapper
    enter into deco_2_wrapper
    result is 7
    over deco_2
    over deco_1


